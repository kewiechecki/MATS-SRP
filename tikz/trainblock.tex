\begin{tikzpicture}[
    node distance = 5mm and 5mm,
    punkt/.style = {rectangle, draw},
    pil/.style = {black, -stealth},
    font=\small
    ]

  %\node[punkt] (preprocessing) {preprocessing} ;
  \node[] (X) {$X^{112 \times n}$} ;

  \node[punkt] (h3) [right=of X] {$\DeePWAK_{\theta_3,\pi_3,\phi_3}$} ;
  \node[punkt] (h2) [above=of h3] {$\DeePWAK_{\theta_2,\pi_2,\phi_2}$} ;
  \node[punkt] (h1) [above=of h2] {$\DeePWAK_{\theta_1,\pi_1,\phi_1}$} ;
  \node[punkt] (h4) [below=of h3] {$\DeePWAK_{\theta_4,\pi_4,\phi_4}$} ;
  \node[punkt] (h5) [below=of h4] {$\DeePWAK_{\theta_5,\pi_5,\phi_5}$} ;

  %\node[] (Xhat1) [below=of h1] {$\hat{X}_1$} ;
  %\node[] (Xhat2) [below=of h2] {$\hat{X}_2$} ;
  %\node[] (Xhat3) [below=of h3] {$\hat{X}_3$} ;
  %\node[] (Xhat4) [below=of h4] {$\hat{X}_4$} ;
  %\node[] (Xhat5) [below=of h5] {$\hat{X}_5$} ;

  \node[punkt] (sum) [right=of h3] {$\sum$} ;
  \node[] (Xhat) [right=of h5] {$\hat{X}$} ;
  \node[punkt] (loss) [below=of h5] {MSE} ;
  \node[] (grad) [right=of loss] {$\nabla$} ;
  \node[punkt] (update) [right=of grad] {$\mathrm{update!}(\theta,\pi,\phi)$} ;
  
  \draw[pil] %(preprocessing) edge (X)

  (X) edge[bend left=30] (h1)
  (X) edge[bend left=30] (h2)
  (X) edge (h3)
  (X) edge[bend right=30] (h4)
  (X) edge[bend right=30] (h5)

  (h1) edge[bend left=30] (sum)
  (h2) edge[bend left=30] (sum)
  (h3) edge (sum)
  (h4) edge[bend right=30] (sum)
  (h5) edge[bend right=30] (sum)

  (sum) edge[bend left=15] (Xhat)
  (Xhat) edge[bend left=15] (loss)
  (X) edge[bend right=30] (loss)
  (loss) edge (grad)
  (grad) edge (update);
\end{tikzpicture}

  
